CREATE TABLE professores ( 
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY, 
    nome VARCHAR2(100) NOT NULL 
);

CREATE TABLE disciplinas ( 
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY, 
    nome VARCHAR2(100) NOT NULL, 
    carga_horaria NUMBER NOT NULL 
);

CREATE TABLE professores_disciplinas ( 
    professor_id NUMBER NOT NULL, 
    disciplina_id NUMBER NOT NULL, 
    FOREIGN KEY (professor_id) REFERENCES professores(id), 
    FOREIGN KEY (disciplina_id) REFERENCES disciplinas(id), 
    PRIMARY KEY (professor_id, disciplina_id) 
);

INSERT INTO professores (nome) VALUES ('Ana Oliveira');

INSERT INTO professores (nome) VALUES ('Carlos Silva');

INSERT INTO professores (nome) VALUES ('Beatriz Santos');

INSERT INTO disciplinas (nome, carga_horaria) VALUES ('Cálculo', 105);

INSERT INTO disciplinas (nome, carga_horaria) VALUES ('Física', 95);

INSERT INTO disciplinas (nome, carga_horaria) VALUES ('Química', 110);

INSERT INTO disciplinas (nome, carga_horaria) VALUES ('História', 120);

INSERT INTO disciplinas (nome, carga_horaria) VALUES ('Álgebra', 130);

INSERT INTO professores_disciplinas (professor_id, disciplina_id) VALUES (1, 1);

INSERT INTO professores_disciplinas (professor_id, disciplina_id) VALUES (1, 3);

INSERT INTO professores_disciplinas (professor_id, disciplina_id) VALUES (1, 5);

INSERT INTO professores_disciplinas (professor_id, disciplina_id) VALUES (2, 2);

INSERT INTO professores_disciplinas (professor_id, disciplina_id) VALUES (2, 4);

INSERT INTO professores_disciplinas (professor_id, disciplina_id) VALUES (3, 3);

INSERT INTO professores_disciplinas (professor_id, disciplina_id) VALUES (3, 4);

INSERT INTO professores_disciplinas (professor_id, disciplina_id) VALUES (3, 5);

SELECT p.nome 
FROM professores p 
JOIN professores_disciplinas pd ON p.id = pd.professor_id 
JOIN disciplinas d ON pd.disciplina_id = d.id 
WHERE d.carga_horaria > 100 
GROUP BY p.nome 
HAVING COUNT(d.id) > 2;
