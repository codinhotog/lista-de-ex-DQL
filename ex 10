CREATE TABLE cursos ( 
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY, 
    nome VARCHAR2(100) NOT NULL 
);

CREATE TABLE disciplinas ( 
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY, 
    nome VARCHAR2(100) NOT NULL, 
    carga_horaria NUMBER NOT NULL 
);

CREATE TABLE cursos_disciplinas ( 
    curso_id NUMBER NOT NULL, 
    disciplina_id NUMBER NOT NULL, 
    FOREIGN KEY (curso_id) REFERENCES cursos(id), 
    FOREIGN KEY (disciplina_id) REFERENCES disciplinas(id) 
);

INSERT INTO cursos (nome) VALUES ('Engenharia');

INSERT INTO cursos (nome) VALUES ('Medicina');

INSERT INTO cursos (nome) VALUES ('Direito');

INSERT INTO cursos (nome) VALUES ('Ciências da Computação');

INSERT INTO disciplinas (nome, carga_horaria) VALUES ('Cálculo', 500);

INSERT INTO disciplinas (nome, carga_horaria) VALUES ('Física', 400);

INSERT INTO disciplinas (nome, carga_horaria) VALUES ('Histologia', 600);

INSERT INTO disciplinas (nome, carga_horaria) VALUES ('Anatomia', 700);

INSERT INTO disciplinas (nome, carga_horaria) VALUES ('Programação', 300);

INSERT INTO disciplinas (nome, carga_horaria) VALUES ('Algoritmos', 350);

INSERT INTO disciplinas (nome, carga_horaria) VALUES ('Direito Constitucional', 450);

INSERT INTO disciplinas (nome, carga_horaria) VALUES ('Direito Penal', 400);

INSERT INTO cursos_disciplinas (curso_id, disciplina_id) VALUES (1, 1);

INSERT INTO cursos_disciplinas (curso_id, disciplina_id) VALUES (1, 2);

INSERT INTO cursos_disciplinas (curso_id, disciplina_id) VALUES (2, 3);

INSERT INTO cursos_disciplinas (curso_id, disciplina_id) VALUES (2, 4);

INSERT INTO cursos_disciplinas (curso_id, disciplina_id) VALUES (3, 7);

INSERT INTO cursos_disciplinas (curso_id, disciplina_id) VALUES (3, 8);

INSERT INTO cursos_disciplinas (curso_id, disciplina_id) VALUES (4, 5);

INSERT INTO cursos_disciplinas (curso_id, disciplina_id) VALUES (4, 6);

SELECT c.nome AS curso, AVG(d.carga_horaria) AS media_carga_horaria 
FROM cursos c 
JOIN cursos_disciplinas cd ON c.id = cd.curso_id 
JOIN disciplinas d ON cd.disciplina_id = d.id 
GROUP BY c.nome;
