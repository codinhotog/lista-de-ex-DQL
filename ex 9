CREATE TABLE professores ( 
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY, 
    nome VARCHAR2(100) NOT NULL 
);

CREATE TABLE turmas ( 
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY, 
    nome VARCHAR2(100) NOT NULL 
);

CREATE TABLE professores_turmas ( 
    professor_id NUMBER NOT NULL, 
    turma_id NUMBER NOT NULL, 
    FOREIGN KEY (professor_id) REFERENCES professores(id), 
    FOREIGN KEY (turma_id) REFERENCES turmas(id) 
);

INSERT INTO professores (nome) VALUES ('Ana Oliveira');

INSERT INTO professores (nome) VALUES ('Carlos Silva');

INSERT INTO professores (nome) VALUES ('Beatriz Santos');

INSERT INTO professores (nome) VALUES ('Daniel Lima');

INSERT INTO professores (nome) VALUES ('Eduardo Pereira');

INSERT INTO turmas (nome) VALUES ('Turma A');

INSERT INTO turmas (nome) VALUES ('Turma B');

INSERT INTO turmas (nome) VALUES ('Turma C');

INSERT INTO turmas (nome) VALUES ('Turma D');

INSERT INTO turmas (nome) VALUES ('Turma E');

INSERT INTO turmas (nome) VALUES ('Turma F');

INSERT INTO professores_turmas (professor_id, turma_id) VALUES (1, 1);

INSERT INTO professores_turmas (professor_id, turma_id) VALUES (1, 2);

INSERT INTO professores_turmas (professor_id, turma_id) VALUES (1, 3);

INSERT INTO professores_turmas (professor_id, turma_id) VALUES (2, 1);

INSERT INTO professores_turmas (professor_id, turma_id) VALUES (2, 4);

INSERT INTO professores_turmas (professor_id, turma_id) VALUES (3, 1);

INSERT INTO professores_turmas (professor_id, turma_id) VALUES (3, 5);

INSERT INTO professores_turmas (professor_id, turma_id) VALUES (4, 1);

INSERT INTO professores_turmas (professor_id, turma_id) VALUES (4, 2);

INSERT INTO professores_turmas (professor_id, turma_id) VALUES (4, 3);

INSERT INTO professores_turmas (professor_id, turma_id) VALUES (4, 6);

INSERT INTO professores_turmas (professor_id, turma_id) VALUES (5, 3);

INSERT INTO professores_turmas (professor_id, turma_id) VALUES (5, 4);

INSERT INTO professores_turmas (professor_id, turma_id) VALUES (5, 5);

INSERT INTO professores_turmas (professor_id, turma_id) VALUES (5, 6);

SELECT p.nome AS professor, COUNT(pt.turma_id) AS total_turmas 
FROM professores p 
JOIN professores_turmas pt ON p.id = pt.professor_id 
GROUP BY p.nome 
ORDER BY total_turmas DESC;
