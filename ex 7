CREATE TABLE alunos ( 
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY, 
    nome VARCHAR2(100) NOT NULL 
);

CREATE TABLE disciplinas ( 
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY, 
    nome VARCHAR2(100) NOT NULL 
);

CREATE TABLE alunos_disciplinas ( 
    aluno_id NUMBER NOT NULL, 
    disciplina_id NUMBER NOT NULL, 
    FOREIGN KEY (aluno_id) REFERENCES alunos(id), 
    FOREIGN KEY (disciplina_id) REFERENCES disciplinas(id) 
);

INSERT INTO alunos (nome) VALUES ('João Silva');

INSERT INTO alunos (nome) VALUES ('Maria Santos');

INSERT INTO alunos (nome) VALUES ('Pedro Oliveira');

INSERT INTO alunos (nome) VALUES ('Ana Costa');

INSERT INTO alunos (nome) VALUES ('Lucas Lima');

INSERT INTO disciplinas (nome) VALUES ('Matemática');

INSERT INTO alunos (nome) VALUES ('Pedro Oliveira');

INSERT INTO alunos (nome) VALUES ('Ana Costa');

INSERT INTO alunos (nome) VALUES ('Lucas Lima');

INSERT INTO disciplinas (nome) VALUES ('Matemática');

INSERT INTO disciplinas (nome) VALUES ('Física');

INSERT INTO disciplinas (nome) VALUES ('História');

INSERT INTO disciplinas (nome) VALUES ('Química');

INSERT INTO disciplinas (nome) VALUES ('Biologia');

INSERT INTO alunos_disciplinas (aluno_id, disciplina_id) VALUES (1, 1);

INSERT INTO alunos_disciplinas (aluno_id, disciplina_id) VALUES (1, 2);

INSERT INTO alunos_disciplinas (aluno_id, disciplina_id) VALUES (2, 2);

INSERT INTO alunos_disciplinas (aluno_id, disciplina_id) VALUES (2, 3);

INSERT INTO alunos_disciplinas (aluno_id, disciplina_id) VALUES (2, 4);

INSERT INTO alunos_disciplinas (aluno_id, disciplina_id) VALUES (3, 1);

INSERT INTO alunos_disciplinas (aluno_id, disciplina_id) VALUES (3, 3);

INSERT INTO alunos_disciplinas (aluno_id, disciplina_id) VALUES (4, 1);

INSERT INTO alunos_disciplinas (aluno_id, disciplina_id) VALUES (4, 4);

INSERT INTO alunos_disciplinas (aluno_id, disciplina_id) VALUES (4, 5);

INSERT INTO alunos_disciplinas (aluno_id, disciplina_id) VALUES (5, 2);

SELECT a.nome, COUNT(ad.disciplina_id) AS numero_disciplinas 
FROM alunos a 
JOIN alunos_disciplinas ad ON a.id = ad.aluno_id 
GROUP BY a.nome 
HAVING COUNT(ad.disciplina_id) > 1 
ORDER BY numero_disciplinas DESC;
