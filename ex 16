CREATE TABLE cursos ( 
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY, 
    nome VARCHAR2(100) NOT NULL 
);

CREATE TABLE disciplinas ( 
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY, 
    nome VARCHAR2(100) NOT NULL, 
    carga_horaria NUMBER NOT NULL 
);

CREATE TABLE curso_disciplina ( 
    curso_id NUMBER NOT NULL, 
    disciplina_id NUMBER NOT NULL, 
    FOREIGN KEY (curso_id) REFERENCES cursos(id), 
    FOREIGN KEY (disciplina_id) REFERENCES disciplinas(id), 
    PRIMARY KEY (curso_id, disciplina_id) 
);

INSERT INTO cursos (nome) VALUES ('Engenharia');

INSERT INTO cursos (nome) VALUES ('Matemática');

INSERT INTO cursos (nome) VALUES ('História');

INSERT INTO disciplinas (nome, carga_horaria) VALUES ('Cálculo', 100);

INSERT INTO disciplinas (nome, carga_horaria) VALUES ('Física', 60);

INSERT INTO disciplinas (nome, carga_horaria) VALUES ('História Antiga', 90);

INSERT INTO disciplinas (nome, carga_horaria) VALUES ('Álgebra', 80);

INSERT INTO disciplinas (nome, carga_horaria) VALUES ('Química', 70);

INSERT INTO curso_disciplina (curso_id, disciplina_id) VALUES (1, 1);

INSERT INTO curso_disciplina (curso_id, disciplina_id) VALUES (1, 2);

INSERT INTO curso_disciplina (curso_id, disciplina_id) VALUES (1, 5);

INSERT INTO curso_disciplina (curso_id, disciplina_id) VALUES (2, 1);

INSERT INTO curso_disciplina (curso_id, disciplina_id) VALUES (2, 4);

INSERT INTO curso_disciplina (curso_id, disciplina_id) VALUES (3, 3);

SELECT c.nome AS curso, COUNT(cd.disciplina_id) AS quantidade_disciplinas 
FROM cursos c 
LEFT JOIN curso_disciplina cd ON c.id = cd.curso_id 
GROUP BY c.nome 
ORDER BY quantidade_disciplinas DESC;
