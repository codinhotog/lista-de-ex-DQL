CREATE TABLE alunos ( 
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY, 
    nome VARCHAR2(100) NOT NULL 
);

CREATE TABLE disciplinas ( 
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY, 
    nome VARCHAR2(100) NOT NULL 
);

CREATE TABLE matriculas ( 
    aluno_id NUMBER NOT NULL, 
    disciplina_id NUMBER NOT NULL, 
    FOREIGN KEY (aluno_id) REFERENCES alunos(id), 
    FOREIGN KEY (disciplina_id) REFERENCES disciplinas(id) 
);

INSERT INTO alunos (nome) VALUES ('João Silva');

INSERT INTO alunos (nome) VALUES ('Maria Santos');

INSERT INTO alunos (nome) VALUES ('Pedro Oliveira');

INSERT INTO alunos (nome) VALUES ('Ana Costa');

INSERT INTO alunos (nome) VALUES ('Lucas Lima');

INSERT INTO disciplinas (nome) VALUES ('Matemática');

INSERT INTO disciplinas (nome) VALUES ('Física');

INSERT INTO disciplinas (nome) VALUES ('Química');

INSERT INTO disciplinas (nome) VALUES ('História');

INSERT INTO disciplinas (nome) VALUES ('Geografia');

INSERT INTO matriculas (aluno_id, disciplina_id) VALUES (1, 1);

INSERT INTO matriculas (aluno_id, disciplina_id) VALUES (1, 2);

INSERT INTO matriculas (aluno_id, disciplina_id) VALUES (2, 1);

INSERT INTO matriculas (aluno_id, disciplina_id) VALUES (2, 3);

INSERT INTO matriculas (aluno_id, disciplina_id) VALUES (3, 1);

INSERT INTO matriculas (aluno_id, disciplina_id) VALUES (3, 4);

INSERT INTO matriculas (aluno_id, disciplina_id) VALUES (4, 3);

INSERT INTO matriculas (aluno_id, disciplina_id) VALUES (4, 5);

INSERT INTO matriculas (aluno_id, disciplina_id) VALUES (5, 2);

INSERT INTO matriculas (aluno_id, disciplina_id) VALUES (5, 5);

SELECT d.nome AS disciplina, COUNT(m.aluno_id) AS numero_de_alunos 
FROM disciplinas d 
JOIN matriculas m ON d.id = m.disciplina_id 
GROUP BY d.nome 
ORDER BY numero_de_alunos DESC;
